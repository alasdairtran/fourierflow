# time_step: 0.0002191401125550916
domain:
  - [0, '${eval:4 * ${import:numpy.pi}}']
  - [0, '${eval:4 * ${import:numpy.pi}}']
sim_grid:
  _target_: fourierflow.utils.Grid
  shape: [4096, 4096] # double the length scale
  domain: ${domain} # size of the domain during simulation
time_step:
  _target_: jax_cfd.base.equations.stable_time_step
  max_velocity: 7.0 # maximum velocity of the fluid
  max_courant_number: 0.5
  viscosity: 1e-3
  grid: ${sim_grid}
method: pseudo_spectral
step_fn:
  _target_: jax_cfd.spectral.time_stepping.crank_nicolson_rk4
  equation:
    _target_: jax_cfd.spectral.equations.NavierStokes2D
    grid: ${sim_grid}
    viscosity: 0.0005 # half the visocity
    drag: 0.1
    smooth: true # use anti-aliasing
    forcing_fn: # half the forcing strength scale
      _target_: functools.partial
      _args_: ["${get_method:fourierflow.utils.kolmogorov_forcing_fn}"]
      scale: -2
      k: 2
  time_step: ${time_step}
downsample_fn: ${get_method:fourierflow.builders.kolmogorov.downsample_vorticity}
out_sizes: [32, 64, 128, 256, 512, 1024, 2048, 4096] # size of the domain for saving to disk
n_trajectories: 4 # number of trajectories to generate
density: 1 # density of the fluid
max_velocity: 7.0 # maximum velocity of the fluid
peak_wavenumber: 4.0 # initial peak wavenumber of the velocity field
seed: 24312 # random seed for the initial velocity field
inner_steps: 64 # take a snapshot of the field once every these many ODE steps
outer_steps: 0 # we only want to initial vorticity field
warmup_steps: 2852 # equivalent to 40 time units
